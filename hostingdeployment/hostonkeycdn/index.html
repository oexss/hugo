<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Host on KeyCDN # https://gohugo.io/hosting-and-deployment/hosting-on-keycdn/ Accelerate your Hugo site globally with a KeyCDN integration. This tutorial shows you how to set up your static site as a GitLab page behind a KeyCDN pull zone. KeyCDN provides a multitude of features to help accelerate and secure your Hugo site globally including Brotli compression, Let’s Encrypt support, Origin Shield, and more. Assumptions # You already have a Hugo"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://t.is-local.org/hugo/hostingdeployment/hostonkeycdn/"><meta property="og:site_name" content="HUGO"><meta property="og:title" content="Host on KeyCDN"><meta property="og:description" content="Host on KeyCDN # https://gohugo.io/hosting-and-deployment/hosting-on-keycdn/ Accelerate your Hugo site globally with a KeyCDN integration. This tutorial shows you how to set up your static site as a GitLab page behind a KeyCDN pull zone. KeyCDN provides a multitude of features to help accelerate and secure your Hugo site globally including Brotli compression, Let’s Encrypt support, Origin Shield, and more. Assumptions # You already have a Hugo"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="hostingdeployment"><meta property="article:published_time" content="2023-05-18T17:03:08+08:00"><meta property="article:modified_time" content="2023-05-18T17:03:08+08:00"><title>Host on KeyCDN | HUGO</title>
<link rel=manifest href=/hugo/manifest.json><link rel=icon href=/hugo/favicon.png><link rel=canonical href=https://t.is-local.org/hugo/hostingdeployment/hostonkeycdn/><link rel=stylesheet href=/hugo/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/hugo/fuse.min.js></script><script defer src=/hugo/zh-cn.search.min.a426f3a0e1e8951a39b1b352645e382bb08b14b3d53468b1f8b07b0d0928cfe6.js integrity="sha256-pCbzoOHolRo5sbNSZF44K7CLFLPVNGix+LB7DQkoz+Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/hugo/><span>HUGO</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder aria-label maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/hugo/svg/translate.svg class=book-icon alt=Languages>
中文</a></label><ul><li><a href=https://t.is-local.org/hugo/en/>English</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/hugo/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Host on KeyCDN</strong>
<label for=toc-control><img src=/hugo/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#assumptions>Assumptions</a></li><li><a href=#create-a-keycdn-pull-zone>Create a KeyCDN Pull Zone</a></li><li><a href=#configure-your-gitlab-ciyml-file>Configure Your .gitlab-ci.yml File</a></li><li><a href=#push-your-changes-to-gitlab>Push Your Changes to GitLab</a></li><li><a href=#另请参阅>另请参阅</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=host-on-keycdn>Host on KeyCDN
<a class=anchor href=#host-on-keycdn>#</a></h1><p><a href=https://gohugo.io/hosting-and-deployment/hosting-on-keycdn/>https://gohugo.io/hosting-and-deployment/hosting-on-keycdn/</a></p><p>Accelerate your Hugo site globally with a KeyCDN integration. This tutorial shows you how to set up your static site as a GitLab page behind a KeyCDN pull zone.</p><p><a href=https://www.keycdn.com/>KeyCDN</a> provides a multitude of features to help accelerate and secure your Hugo site globally including Brotli compression, Let’s Encrypt support, Origin Shield, and more.</p><h2 id=assumptions>Assumptions
<a class=anchor href=#assumptions>#</a></h2><ul><li>You already have a Hugo page configured</li><li>You have a GitLab account</li><li>You have a KeyCDN account</li></ul><h2 id=create-a-keycdn-pull-zone>Create a KeyCDN Pull Zone
<a class=anchor href=#create-a-keycdn-pull-zone>#</a></h2><p>The first step will be to log in to your KeyCDN account and create a new zone. Name this whatever you like and select the <a href=https://www.keycdn.com/support/create-a-pull-zone/>Pull Zone</a> option. As for the origin URL, your site will be running on <a href=https://docs.gitlab.com/ee/user/project/pages/getting_started_part_one.html>GitLab Pages</a> with a URL of <code>https://youruser.gitlab.io/reponame/</code>. Use this as the Origin URL.</p><p><img src=../hugo/HostOnKeyCDN_img/keycdn-pull-zone.png alt="Screenshot of KeyCDN’s pull zone creation page" data-cur-dir=. data-rg=/hugo/HostOnKeyCDN_img/keycdn-pull-zone.png data-rel=/hugo/HostOnKeyCDN_img/keycdn-pull-zone.png data-2my></p><p>While the origin location doesn’t exist yet, you will need to use your new Zone URL address (or <a href=https://www.keycdn.com/support/create-a-zone-alias/>Zone Alias</a>) in the <code>.gitlab-ci.yml</code> file that will be uploaded to your GitLab project.</p><p>Ensure that you use your Zone URL or Zone alias as the <code>BASEURL</code> variable in the example below. This will be the user-visible website address.</p><h2 id=configure-your-gitlab-ciyml-file>Configure Your .gitlab-ci.yml File
<a class=anchor href=#configure-your-gitlab-ciyml-file>#</a></h2><p>Your <code>.gitlab-ci.yml</code> file should look similar to the example below. Be sure to modify any variables that are specific to your setup.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>image</span>: <span style=color:#ae81ff>alpine:latest</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>variables</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>BASEURL</span>: <span style=color:#e6db74>&#34;https://cipull-7bb7.kxcdn.com/&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>HUGO_VERSION</span>: <span style=color:#e6db74>&#34;0.26&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>HUGO_CHECKSUM</span>: <span style=color:#e6db74>&#34;67e4ba5ec2a02c8164b6846e30a17cc765b0165a5b183d5e480149baf54e1a50&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>KEYCDN_ZONE_ID</span>: <span style=color:#e6db74>&#34;75544&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>before_script</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>apk update</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>apk add curl</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>pages</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>stage</span>: <span style=color:#ae81ff>deploy</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>script</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>apk add git</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>git submodule update --init</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>curl -sSL https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_Linux-64bit.tar.gz -o /tmp/hugo.tar.gz</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>echo &#34;${HUGO_CHECKSUM}  /tmp/hugo.tar.gz&#34; | sha256sum -c</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>tar xf /tmp/hugo.tar.gz hugo -C /tmp/ &amp;&amp; cp /tmp/hugo /usr/bin</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>hugo --baseURL ${BASEURL}</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>curl &#34;https://api.keycdn.com/zones/purge/${KEYCDN_ZONE_ID}.json&#34; -u &#34;${KEYCDN_API_KEY}:&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>artifacts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>public</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>only</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>master</span>
</span></span></code></pre></div><p>Using this integration method, you will have to specify the Zone ID and your <a href=https://www.keycdn.com/api>KeyCDN API</a> key as secret variables. To do this, navigate to the top-left menu bar in GitLab and select Projects. Then, select your project and click on the Settings page. Finally, select Pipelines from the sub-menu and scroll down to the Secret Variable section.</p><p>The Secret Variable for your Zone ID should look similar to:</p><p><img src=../hugo/HostOnKeyCDN_img/secret-zone-id.png alt="Screenshot of setting the Zone ID secret variable" data-cur-dir=. data-rg=/hugo/HostOnKeyCDN_img/secret-zone-id.png data-rel=/hugo/HostOnKeyCDN_img/secret-zone-id.png data-2my></p><p>While the Secret Variable for your API Key will look similar to:</p><p><img src=../hugo/HostOnKeyCDN_img/secret-api-key.png alt="Screenshot of setting the API Key secret variable" data-cur-dir=. data-rg=/hugo/HostOnKeyCDN_img/secret-api-key.png data-rel=/hugo/HostOnKeyCDN_img/secret-api-key.png data-2my></p><p>The Zone ID and API key are used to purge your zone – it’s not strictly needed but otherwise, the CDN might deliver older versions of your assets for quite a while.</p><h2 id=push-your-changes-to-gitlab>Push Your Changes to GitLab
<a class=anchor href=#push-your-changes-to-gitlab>#</a></h2><p>Now it’s time to push the newly created repository to GitLab:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git remote add origin git@gitlab.com:youruser/ci-example.git
</span></span><span style=display:flex><span>git push -u origin master
</span></span></code></pre></div><p>You can watch the progress and CI job output in your Gitlab project under &ldquo;Pipelines&rdquo;.</p><p>After verifying your CI job ran without issues, first check that your GitLab page shows up under <code>https://youruser.gitlab.io/reponame/</code> (it might look broken depending on your browser settings as all links point to your KeyCDN zone – don’t worry about that) and then by heading to whatever Zone alias / Zone URL you defined.</p><p>To learn more about Hugo hosting options with KeyCDN, check out the complete <a href=https://www.keycdn.com/support/hugo-hosting/>Hugo hosting with KeyCDN integration guide</a>.</p><h2 id=另请参阅>另请参阅
<a class=anchor href=#%e5%8f%a6%e8%af%b7%e5%8f%82%e9%98%85>#</a></h2><ul><li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-azure/>Host on Azure Static Web Apps</a></li><li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-gitlab/>Host on GitLab</a></li><li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-netlify/>Host on Netlify</a></li><li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-render/>Host on Render</a></li><li><a href=https://gohugo.io/hosting-and-deployment/hugo-deploy/>Hugo Deploy</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#assumptions>Assumptions</a></li><li><a href=#create-a-keycdn-pull-zone>Create a KeyCDN Pull Zone</a></li><li><a href=#configure-your-gitlab-ciyml-file>Configure Your .gitlab-ci.yml File</a></li><li><a href=#push-your-changes-to-gitlab>Push Your Changes to GitLab</a></li><li><a href=#另请参阅>另请参阅</a></li></ul></nav></div></aside></main></body></html>
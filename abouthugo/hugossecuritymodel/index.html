<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Hugo&rsquo;s Security Model - Hugo 的安全模型 # https://gohugo.io/about/security-model/ Hugo 安全模型的概述。 运行时安全 # ​ Hugo 生成静态输出，因此一旦构建完成，运行时就是浏览器（假设输出为 HTML）和任何与之集"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://t.is-local.org/hugo/abouthugo/hugossecuritymodel/"><meta property="og:site_name" content="HUGO"><meta property="og:title" content="Hugo 的安全模型"><meta property="og:description" content="Hugo’s Security Model - Hugo 的安全模型 # https://gohugo.io/about/security-model/ Hugo 安全模型的概述。 运行时安全 # ​ Hugo 生成静态输出，因此一旦构建完成，运行时就是浏览器（假设输出为 HTML）和任何与之集"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="abouthugo"><meta property="article:published_time" content="2023-05-22T13:22:08+08:00"><meta property="article:modified_time" content="2023-05-22T13:22:08+08:00"><title>Hugo 的安全模型 | HUGO</title>
<link rel=manifest href=/hugo/manifest.json><link rel=icon href=/hugo/favicon.png><link rel=canonical href=https://t.is-local.org/hugo/abouthugo/hugossecuritymodel/><link rel=stylesheet href=/hugo/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/hugo/fuse.min.js></script><script defer src=/hugo/zh-cn.search.min.a426f3a0e1e8951a39b1b352645e382bb08b14b3d53468b1f8b07b0d0928cfe6.js integrity="sha256-pCbzoOHolRo5sbNSZF44K7CLFLPVNGix+LB7DQkoz+Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/hugo/><span>HUGO</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder aria-label maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/hugo/svg/translate.svg class=book-icon alt=Languages>
中文</a></label><ul><li><a href=https://t.is-local.org/hugo/en/>English</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/hugo/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Hugo 的安全模型</strong>
<label for=toc-control><img src=/hugo/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#运行时安全>运行时安全</a></li><li><a href=#安全策略>安全策略</a></li><li><a href=#依赖安全性>依赖安全性</a></li><li><a href=#web-应用程序安全性>Web 应用程序安全性</a></li><li><a href=#另请参阅->另请参阅 ：</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=hugos-security-model---hugo-的安全模型>Hugo&rsquo;s Security Model - Hugo 的安全模型
<a class=anchor href=#hugos-security-model---hugo-%e7%9a%84%e5%ae%89%e5%85%a8%e6%a8%a1%e5%9e%8b>#</a></h1><p><a href=https://gohugo.io/about/security-model/>https://gohugo.io/about/security-model/</a></p><p>Hugo 安全模型的概述。</p><h2 id=运行时安全>运行时安全
<a class=anchor href=#%e8%bf%90%e8%a1%8c%e6%97%b6%e5%ae%89%e5%85%a8>#</a></h2><p>​ Hugo 生成静态输出，因此一旦构建完成，运行时就是浏览器（假设输出为 HTML）和任何与之集成的服务器（API）。</p><p>​ 但在开发和构建站点时，运行时是 <code>hugo</code> 可执行文件。保护运行时可能是<a href=https://blog.logrocket.com/how-to-protect-your-node-js-applications-from-malicious-dependencies-5f2e60ea08f9/>一个真正的挑战</a>。</p><p>​ Hugo 的主要方法是沙盒化和采用严格默认的安全策略：</p><ul><li>Hugo 有一个虚拟文件系统，只有主项目（而不是第三方组件）可以挂载项目根目录外的目录或文件。</li><li>只有主项目可以遍历符号链接。</li><li>用户定义的组件只能以只读方式访问文件系统。</li><li>我们调用一些外部二进制文件来支持 <a href=https://gohugo.io/content-management/formats/#list-of-content-formats>Asciidoctor</a>等功能，但这些二进制文件及其标志都是预定义的，并且默认情况下被禁用（请参见以下安全策略）。运行任意外部操作系统命令的一般函数<a href=https://github.com/gohugoio/hugo/issues/796>已经讨论过</a>，但由于安全问题而未实现。</li></ul><h2 id=安全策略>安全策略
<a class=anchor href=#%e5%ae%89%e5%85%a8%e7%ad%96%e7%95%a5>#</a></h2><p>​ Hugo 具有内置的安全策略，限制对 <a href=https://pkg.go.dev/os/exec>os/exec</a>、远程通信等的访问。</p><p>​ 默认配置如下。任何使用安全策略允许列表中不存在的功能构建都将失败，并显示详细的消息，说明需要进行哪些操作。这些设置大多是允许列表（字符串或切片、<a href=https://pkg.go.dev/regexp>正则表达式</a>或<code>none</code>不匹配任何内容）。</p><p>=== &ldquo;yaml&rdquo;</p><pre><code>```yaml
security:
  enableInlineShortcodes: false
  exec:
    allow:
    - ^dart-sass-embedded$
    - ^go$
    - ^npx$
    - ^postcss$
    osEnv:
    - (?i)^((HTTPS?|NO)_PROXY|PATH(EXT)?|APPDATA|TE?MP|TERM|GO\w+)$
  funcs:
    getenv:
    - ^HUGO_
    - ^CI$
  http:
    methods:
    - (?i)GET|POST
    urls:
    - .*
```
</code></pre><p>=== &ldquo;toml&rdquo;</p><pre><code>```toml
[security]
  enableInlineShortcodes = false
  [security.exec]
    allow = ['^dart-sass-embedded$', '^go$', '^npx$', '^postcss$']
    osEnv = ['(?i)^((HTTPS?|NO)_PROXY|PATH(EXT)?|APPDATA|TE?MP|TERM|GO\w+)$']
  [security.funcs]
    getenv = ['^HUGO_', '^CI$']
  [security.http]
    methods = ['(?i)GET|POST']
    urls = ['.*']
```
</code></pre><p>=== &ldquo;json&rdquo;</p><pre><code>```json
{
   &quot;security&quot;: {
      &quot;enableInlineShortcodes&quot;: false,
      &quot;exec&quot;: {
         &quot;allow&quot;: [
            &quot;^dart-sass-embedded$&quot;,
            &quot;^go$&quot;,
            &quot;^npx$&quot;,
            &quot;^postcss$&quot;
         ],
         &quot;osEnv&quot;: [
            &quot;(?i)^((HTTPS?|NO)_PROXY|PATH(EXT)?|APPDATA|TE?MP|TERM|GO\\w+)$&quot;
         ]
      },
      &quot;funcs&quot;: {
         &quot;getenv&quot;: [
            &quot;^HUGO_&quot;,
            &quot;^CI$&quot;
         ]
      },
      &quot;http&quot;: {
         &quot;methods&quot;: [
            &quot;(?i)GET|POST&quot;
         ],
         &quot;urls&quot;: [
            &quot;.*&quot;
         ]
      }
   }
}
```
</code></pre><p>​ 注意，Hugo 中的这些和其他配置设置可以被操作系统环境覆盖。如果您想阻止所有远程 HTTP 获取数据：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>HUGO_SECURITY_HTTP_URLS=none hugo
</span></span></code></pre></div><h2 id=依赖安全性>依赖安全性
<a class=anchor href=#%e4%be%9d%e8%b5%96%e5%ae%89%e5%85%a8%e6%80%a7>#</a></h2><p>​ Hugo 作为一个静态二进制文件使用 <a href=https://github.com/golang/go/wiki/Modules>Go Modules</a> 来管理其依赖项。Go Modules 有几个保障措施，其中之一是 <code>go.sum</code> 文件。这是所有依赖项（包括传递依赖项）的预期密码校验和的数据库。</p><p>​ <a href=https://gohugo.io/hugo-modules/>Hugo Modules</a> 是在 Go Modules 的功能之上构建的一个功能。像 Go Modules 一样，使用 Hugo Modules 的 Hugo 项目将有一个 <code>go.sum</code> 文件。我们建议将此文件提交到您的版本控制系统中。如果存在校验和不匹配，则 Hugo 构建将失败，这将表明<a href=https://julienrenaux.fr/2019/12/20/github-actions-security-risk/>依赖项被篡改</a>。</p><h2 id=web-应用程序安全性>Web 应用程序安全性
<a class=anchor href=#web-%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e5%ae%89%e5%85%a8%e6%80%a7>#</a></h2><p>​ 以下是 <a href=https://en.wikipedia.org/wiki/OWASP>OWASP</a>定义的安全威胁。</p><p>​ 对于 HTML 输出，这是核心安全模型：</p><p><a href=https://pkg.go.dev/html/template#hdr-Security_Model>https://pkg.go.dev/html/template#hdr-Security_Model</a></p><p>简而言之：</p><p>​ 模板和配置作者（您）是可信任的，但您发送的数据不是。这就是为什么有时需要使用安全函数，如 <code>safeHTML</code>，以避免转义您知道是安全的数据。正如文档中所指出的一样，上述规则有一个例外：如果您启用内联shortcode，您也表明在内容文件中shortcode和数据处理是可信的，因为这些宏被视为纯文本。值得一提的是，Hugo 是一个静态站点生成器，没有动态用户输入的概念。</p><p>​ 对于内容， 默认的 Markdown 渲染器<a href=https://gohugo.io/getting-started/configuration-markup>配置</a>为删除或转义潜在的不安全内容。如果您信任自己的内容，则可以重新配置此行为。</p><h2 id=另请参阅->另请参阅 ：
<a class=anchor href=#%e5%8f%a6%e8%af%b7%e5%8f%82%e9%98%85->#</a></h2><ul><li><a href=../HugoAndGDPR>Hugo 与通用数据保护条例（GDPR）</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#运行时安全>运行时安全</a></li><li><a href=#安全策略>安全策略</a></li><li><a href=#依赖安全性>依赖安全性</a></li><li><a href=#web-应用程序安全性>Web 应用程序安全性</a></li><li><a href=#另请参阅->另请参阅 ：</a></li></ul></nav></div></aside></main></body></html>
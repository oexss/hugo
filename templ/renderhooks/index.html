<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Markdown Render Hooks - Markdown渲染钩子 # https://gohugo.io/templates/render-hooks/ ​ 渲染钩子允许自定义模板覆盖markdown渲染功能。 ​ 请注意，这只支持Goldmark渲染器。 ​ 您可以"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://t.is-local.org/hugo/templ/renderhooks/"><meta property="og:site_name" content="HUGO"><meta property="og:title" content="Markdown渲染钩子"><meta property="og:description" content="Markdown Render Hooks - Markdown渲染钩子 # https://gohugo.io/templates/render-hooks/ ​ 渲染钩子允许自定义模板覆盖markdown渲染功能。 ​ 请注意，这只支持Goldmark渲染器。 ​ 您可以"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="templ"><meta property="article:published_time" content="2023-05-18T17:03:08+08:00"><meta property="article:modified_time" content="2023-05-18T17:03:08+08:00"><title>Markdown渲染钩子 | HUGO</title>
<link rel=manifest href=/hugo/manifest.json><link rel=icon href=/hugo/favicon.png><link rel=canonical href=https://t.is-local.org/hugo/templ/renderhooks/><link rel=stylesheet href=/hugo/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/hugo/fuse.min.js></script><script defer src=/hugo/zh-cn.search.min.a426f3a0e1e8951a39b1b352645e382bb08b14b3d53468b1f8b07b0d0928cfe6.js integrity="sha256-pCbzoOHolRo5sbNSZF44K7CLFLPVNGix+LB7DQkoz+Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/hugo/><span>HUGO</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder aria-label maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/hugo/svg/translate.svg class=book-icon alt=Languages>
中文</a></label><ul><li><a href=https://t.is-local.org/hugo/en/>English</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/hugo/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Markdown渲染钩子</strong>
<label for=toc-control><img src=/hugo/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#渲染钩子应用于标题链接和图像>渲染钩子应用于标题、链接和图像</a><ul><li><a href=#传递给render-link和render-image的上下文>传递给<code>render-link</code>和<code>render-image</code>的上下文</a></li><li><a href=#传递给render-heading的上下文>传递给<code>render-heading</code>的上下文</a></li><li><a href=#带标题的markdown链接示例>带标题的Markdown链接示例</a></li><li><a href=#图像markdown示例>图像Markdown示例</a></li><li><a href=#标题链接示例>标题链接示例</a></li></ul></li><li><a href=#代码块的渲染钩子>代码块的渲染钩子</a></li><li><a href=#另请参阅>另请参阅</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=markdown-render-hooks---markdown渲染钩子>Markdown Render Hooks - Markdown渲染钩子
<a class=anchor href=#markdown-render-hooks---markdown%e6%b8%b2%e6%9f%93%e9%92%a9%e5%ad%90>#</a></h1><p><a href=https://gohugo.io/templates/render-hooks/>https://gohugo.io/templates/render-hooks/</a></p><p>​ 渲染钩子允许自定义模板覆盖markdown渲染功能。</p><p>​ 请注意，这只支持<a href=[Goldmark]%28https://gohugo.io/getting-started/configuration-markup#goldmark%29>Goldmark</a>渲染器。</p><p>​ 您可以通过在<code>layouts/_default/_markup</code>中创建名称为<code>render-{kind}</code>的模板来覆盖默认的Markdown渲染为HTML的某些部分。</p><p>​ 您还可以在<code>layouts/[type/section]/_markup</code>中创建特定于type/section的钩子，例如：<code>layouts/blog/_markup</code>。</p><p>​ 目前支持的钩子种类有：</p><ul><li><code>image</code></li><li><code>link</code></li><li><code>heading</code></li><li><code>codeblock</code> <a href=https://github.com/gohugoio/hugo/releases/tag/v0.93.0>New in v0.93.0</a></li></ul><p>​ 如果需要，您可以定义特定于<a href=https://gohugo.io/templates/output-formats>输出格式</a>和<a href=https://gohugo.io/content-management/multilingual/>语言</a>的模板。您的<code>layouts</code>文件夹可能如下所示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>layouts/
</span></span><span style=display:flex><span>└── _default/
</span></span><span style=display:flex><span>    └── _markup/
</span></span><span style=display:flex><span>        ├── render-codeblock-bash.html
</span></span><span style=display:flex><span>        ├── render-codeblock.html
</span></span><span style=display:flex><span>        ├── render-heading.html
</span></span><span style=display:flex><span>        ├── render-image.html
</span></span><span style=display:flex><span>        ├── render-image.rss.xml
</span></span><span style=display:flex><span>        └── render-link.html
</span></span></code></pre></div><p>​ 以下是上述用法的一些示例：</p><ul><li>使用<code>.GetPage</code>解析链接引用。这将使链接可移植，因为您可以将<code>./my-post.md</code>（和在GitHub上可以使用的类似构造）转换为<code>/blog/2019/01/01/my-post/</code>等。</li><li>为外部链接添加<code>target=_blank</code>。</li><li>解析和<a href=https://gohugo.io/content-management/image-processing/>处理</a>图像。</li><li>添加<a href=https://remysharp.com/2014/08/08/automatic-permalinks-for-blog-posts>标题链接</a>。</li></ul><h2 id=渲染钩子应用于标题链接和图像>渲染钩子应用于标题、链接和图像
<a class=anchor href=#%e6%b8%b2%e6%9f%93%e9%92%a9%e5%ad%90%e5%ba%94%e7%94%a8%e4%ba%8e%e6%a0%87%e9%a2%98%e9%93%be%e6%8e%a5%e5%92%8c%e5%9b%be%e5%83%8f>#</a></h2><h3 id=传递给render-link和render-image的上下文>传递给<code>render-link</code>和<code>render-image</code>的上下文
<a class=anchor href=#%e4%bc%a0%e9%80%92%e7%bb%99render-link%e5%92%8crender-image%e7%9a%84%e4%b8%8a%e4%b8%8b%e6%96%87>#</a></h3><p>​ <code>render-link</code>和<code>render-image</code>模板将接收到以下上下文：</p><ul><li><p>Page</p><p>正在被渲染的<a href=https://gohugo.io/variables/page/>Page</a>。</p></li><li><p>Destination</p><p>The URL.</p></li><li><p>Title</p><p>title属性。</p></li><li><p>Text</p><p>渲染后的（HTML）链接文本。</p></li><li><p>PlainText</p><p>上述文本的纯文本版本。</p></li></ul><h3 id=传递给render-heading的上下文>传递给<code>render-heading</code>的上下文
<a class=anchor href=#%e4%bc%a0%e9%80%92%e7%bb%99render-heading%e7%9a%84%e4%b8%8a%e4%b8%8b%e6%96%87>#</a></h3><p>​ <code>render-heading</code>模板将接收以下上下文：</p><ul><li><p>Page</p><p>正在被渲染的<a href=https://gohugo.io/variables/page/>页面</a>。</p></li><li><p>Level</p><p>标题级别（1-6）</p></li><li><p>Anchor</p><p>在该页面中唯一的自动生成的HTML id。</p></li><li><p>Text</p><p>被渲染后的（HTML）文本。</p></li><li><p>PlainText</p><p>上述内容的纯文本版本。</p></li><li><p>Attributes (map)</p><p>一个属性映射（例如<code>id</code>、<code>class</code>）。需要注意的是，对于链接，这个映射目前始终为空。</p></li></ul><p>The <code>render-image</code> templates will also receive:</p><p>​ <code>render-image</code>模板还将接收：</p><ul><li><p>IsBlock <a href=https://github.com/gohugoio/hugo/releases/tag/v0.108.0>New in v0.108.0</a></p><p>如果这是一个独立的图像并且配置选项<a href=https://gohugo.io/getting-started/configuration-markup/#goldmark>markup.goldmark.parser.wrapStandAloneImageWithinParagraph</a>被禁用，则返回true。</p></li><li><p>Ordinal <a href=https://github.com/gohugoio/hugo/releases/tag/v0.108.0>New in v0.108.0</a></p><p>当前文档中所有图像的基于零的序数。</p></li></ul><h3 id=带标题的markdown链接示例>带标题的Markdown链接示例
<a class=anchor href=#%e5%b8%a6%e6%a0%87%e9%a2%98%e7%9a%84markdown%e9%93%be%e6%8e%a5%e7%a4%ba%e4%be%8b>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-md data-lang=md><span style=display:flex><span>[<span style=color:#f92672>Text</span>](<span style=color:#a6e22e>https://www.gohugo.io &#34;Title&#34;</span>)
</span></span></code></pre></div><p>​ 以下是render-link.html模板的代码示例：</p><p><code>layouts/_default/_markup/render-link.html</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go-html-template data-lang=go-html-template><span style=display:flex><span>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Destination</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>safeURL</span> <span style=color:#75715e>}}</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#66d9ef>with</span> <span style=color:#a6e22e>.Title</span> <span style=color:#75715e>}}</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.</span> <span style=color:#75715e>}}</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#66d9ef>end</span> <span style=color:#75715e>}}{{</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>strings</span><span style=color:#a6e22e>.HasPrefix</span> <span style=color:#a6e22e>.Destination</span> <span style=color:#e6db74>&#34;http&#34;</span> <span style=color:#75715e>}}</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;noopener&#34;</span><span style=color:#75715e>{{</span> <span style=color:#66d9ef>end</span> <span style=color:#75715e>}}</span>&gt;<span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Text</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>safeHTML</span> <span style=color:#75715e>}}</span>&lt;/<span style=color:#f92672>a</span>&gt;
</span></span></code></pre></div><h3 id=图像markdown示例>图像Markdown示例
<a class=anchor href=#%e5%9b%be%e5%83%8fmarkdown%e7%a4%ba%e4%be%8b>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-md data-lang=md><span style=display:flex><span>![<span style=color:#f92672>Text</span>](<span style=color:#a6e22e>https://gohugo.io/images/hugo-logo-wide.svg &#34;Title&#34;</span>)
</span></span></code></pre></div><p>​ 以下是render-image.html模板的代码示例：</p><p><code>layouts/_default/_markup/render-image.html</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go-html-template data-lang=go-html-template><span style=display:flex><span>&lt;<span style=color:#f92672>p</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;md__image&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Destination</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>safeURL</span> <span style=color:#75715e>}}</span><span style=color:#e6db74>&#34;</span> <span style=color:#a6e22e>alt</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Text</span> <span style=color:#75715e>}}</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e>{{</span> <span style=color:#66d9ef>with</span> <span style=color:#a6e22e>.Title</span> <span style=color:#75715e>}}</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.</span> <span style=color:#75715e>}}</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#66d9ef>end</span> <span style=color:#75715e>}}</span> /&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>p</span>&gt;
</span></span></code></pre></div><h3 id=标题链接示例>标题链接示例
<a class=anchor href=#%e6%a0%87%e9%a2%98%e9%93%be%e6%8e%a5%e7%a4%ba%e4%be%8b>#</a></h3><p>​ 给定此模板文件</p><p><code>layouts/_default/_markup/render-heading.html</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go-html-template data-lang=go-html-template><span style=display:flex><span>&lt;<span style=color:#f92672>h</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Level</span> <span style=color:#75715e>}}</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Anchor</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>safeURL</span> <span style=color:#75715e>}}</span><span style=color:#e6db74>&#34;</span>&gt;<span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Text</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>safeHTML</span> <span style=color:#75715e>}}</span> &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Anchor</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>safeURL</span> <span style=color:#75715e>}}</span><span style=color:#e6db74>&#34;</span>&gt;¶&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>h</span><span style=color:#75715e>{{</span> <span style=color:#a6e22e>.Level</span> <span style=color:#75715e>}}</span>&gt;
</span></span></code></pre></div><p>​ 以及这个 markdown</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-md data-lang=md><span style=display:flex><span><span style=color:#75715e>### Section A
</span></span></span></code></pre></div><p>​ 渲染出的 HTML 代码将是</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>h3</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;section-a&#34;</span>&gt;Section A &lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#section-a&#34;</span>&gt;¶&lt;/<span style=color:#f92672>a</span>&gt;&lt;/<span style=color:#f92672>h3</span>&gt;
</span></span></code></pre></div><h2 id=代码块的渲染钩子>代码块的渲染钩子
<a class=anchor href=#%e4%bb%a3%e7%a0%81%e5%9d%97%e7%9a%84%e6%b8%b2%e6%9f%93%e9%92%a9%e5%ad%90>#</a></h2><p><a href=https://github.com/gohugoio/hugo/releases/tag/v0.93.0>New in v0.93.0</a></p><p>​ 您可以为所有代码块或特定类型/语言（例如下面的<code>bash</code>）添加钩子模板：</p><p><img src=../hugo/RenderHooks_img/image-20230425200136050.png alt=image-20230425200136050 data-cur-dir=. data-rg=/hugo/RenderHooks_img/image-20230425200136050.png data-rel=/hugo/RenderHooks_img/image-20230425200136050.png data-2my></p><p>​ 这些代码块的默认行为是进行<a href=https://gohugo.io/content-management/syntax-highlighting/#highlighting-in-code-fences>代码高亮</a>，但是由于可以向这些代码块传递属性，因此它们可以用于几乎任何事情。一个示例是内置的<a href=https://gohugo.io/content-management/diagrams/#goat-diagrams-ascii>GoAT Diagrams</a>或这个<a href=https://gohugo.io/content-management/diagrams/#mermaid-diagrams>Mermaid Diagram Code Block Hook</a>示例。</p><p>​ 代码块模板中您可以获取到的上下文（"."）包括：</p><ul><li><p>Type (string)</p><p>代码块的类型。这将是编程语言，例如<code>bash</code>，用于进行代码高亮。</p></li><li><p>Attributes (map)</p><p>从Markdown传递的属性（例如<code>{ attrName1=attrValue1 attrName2="attr Value 2" }</code>）。</p></li><li><p>Options (map)</p><p>Chroma 高亮处理选项。仅在 <code>Type</code> 是已知的 <a href=https://gohugo.io/content-management/syntax-highlighting/#list-of-chroma-highlighting-languages>Chroma Lexer</a> 时才填充。</p></li><li><p>Inner (string)</p><p>代码围栏之间的文本。</p></li><li><p>Ordinal (integer)</p><p>当前文档中所有代码块的从零开始的序数。</p></li><li><p>Page</p><p>所属的<code>Page</code>。</p></li><li><p>Position</p><p>在错误日志中有用，因为它会打印出文件名和位置（行号、列号），例如 <code>{{ errorf "error in code block: %s" .Position }}</code>。</p></li></ul><h2 id=另请参阅>另请参阅
<a class=anchor href=#%e5%8f%a6%e8%af%b7%e5%8f%82%e9%98%85>#</a></h2><ul><li><a href=https://gohugo.io/functions/renderstring/>.RenderString</a></li><li>[内容格式 (https://gohugo.io/content-management/formats/)</li><li><a href=https://gohugo.io/content-management/shortcodes/>简码</a></li><li><a href=https://gohugo.io/functions/anchorize/>anchorize</a></li><li><a href=https://gohugo.io/functions/markdownify/>markdownify</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#渲染钩子应用于标题链接和图像>渲染钩子应用于标题、链接和图像</a><ul><li><a href=#传递给render-link和render-image的上下文>传递给<code>render-link</code>和<code>render-image</code>的上下文</a></li><li><a href=#传递给render-heading的上下文>传递给<code>render-heading</code>的上下文</a></li><li><a href=#带标题的markdown链接示例>带标题的Markdown链接示例</a></li><li><a href=#图像markdown示例>图像Markdown示例</a></li><li><a href=#标题链接示例>标题链接示例</a></li></ul></li><li><a href=#代码块的渲染钩子>代码块的渲染钩子</a></li><li><a href=#另请参阅>另请参阅</a></li></ul></nav></div></aside></main></body></html>